<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>More Fans - Competitive Platform</title>
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
Â  Â  Â  Â  Â  Â  max-width: 1200px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  background: #f5f5f5;
Â  Â  Â  Â  }
Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 30px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .team {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border: 1px solid #eee;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .team-name {
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .team-stats {
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  }
Â  Â  Â  Â  button {
Â  Â  Â  Â  Â  Â  background: #667eea;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 8px 16px;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  }
Â  Â  Â  Â  button:hover {
Â  Â  Â  Â  Â  Â  background: #5a67d8;
Â  Â  Â  Â  }
Â  Â  Â  Â  .wallet {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 20px;
Â  Â  Â  Â  Â  Â  right: 20px;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .objective {
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-left: 4px solid #667eea;
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .message {
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  margin: 10px 0;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .success { background: #d4edda; color: #155724; }
Â  Â  Â  Â  .error { background: #f8d7da; color: #721c24; }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="wallet" id="wallet">
Â  Â  Â  Â  <div>ðŸ’° Balance: <span id="balance">-</span></div>
Â  Â  Â  Â  <div style="font-size: 12px; color: #666; margin-top: 5px;">
Â  Â  Â  Â  Â  Â  <span id="username">Guest User</span>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="header">
Â  Â  Â  Â  <h1>More Fans</h1>
Â  Â  Â  Â  <p>Where teams compete on real-world objectives</p>
Â  Â  </div>

Â  Â  <div id="message" class="message"></div>

Â  Â  <div id="main-section">
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <h2>Teams</h2>
Â  Â  Â  Â  Â  Â  <div id="teams-list"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <h2>Active Objectives</h2>
Â  Â  Â  Â  Â  Â  <div id="objectives-list"></div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  const API_URL = 'http://localhost:5000/api';
Â  Â  Â  Â  let fanUser = null; // We'll load this user on init

Â  Â  Â  Â  async function apiCall(endpoint, method = 'GET', data = null) {
Â  Â  Â  Â  Â  Â  const options = {
Â  Â  Â  Â  Â  Â  Â  Â  method,
Â  Â  Â  Â  Â  Â  Â  Â  headers: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'Content-Type': 'application/json'
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (data) {
Â  Â  Â  Â  Â  Â  Â  Â  options.body = JSON.stringify(data);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(`${API_URL}${endpoint}`, options);
Â  Â  Â  Â  Â  Â  Â  Â  const result = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(result.error || 'Request failed');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  return result;
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  showMessage(error.message, 'error');
Â  Â  Â  Â  Â  Â  Â  Â  throw error;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function showMessage(text, type = 'success') {
Â  Â  Â  Â  Â  Â  const msg = document.getElementById('message');
Â  Â  Â  Â  Â  Â  msg.textContent = text;
Â  Â  Â  Â  Â  Â  msg.className = `message ${type}`;
Â  Â  Â  Â  Â  Â  msg.style.display = 'block';
Â  Â  Â  Â  Â  Â  setTimeout(() => msg.style.display = 'none', 3000);
Â  Â  Â  Â  }

Â  Â  Â  Â  async function loadTeams() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const teams = await apiCall('/teams');
Â  Â  Â  Â  Â  Â  Â  Â  const container = document.getElementById('teams-list');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  container.innerHTML = teams.map(team => `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="team">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="team-name">${team.name} ${team.verified ? 'âœ“' : ''}</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="team-stats">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${team.fanCount || 0} fans â€¢Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${team.metrics.totalObjectivesCompleted} completed â€¢Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${team.metrics.successRate}% success
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${fanUser?.followingTeams?.includes(team.teamId)Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ? `<button onclick="unfollowTeam('${team.teamId}')">Unfollow</button>`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  : `<button onclick="followTeam('${team.teamId}')">Follow</button>`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="tipTeam('${team.teamId}')">Tip ðŸ’°</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `).join('');
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Failed to load teams:', error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function loadObjectives() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const objectives = await apiCall('/objectives');
Â  Â  Â  Â  Â  Â  Â  Â  const container = document.getElementById('objectives-list');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  container.innerHTML = objectives.map(obj => `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="objective">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>${obj.title}</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>${obj.description}</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top: 10px; color: #666;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Category: ${obj.category} â€¢Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Reward: ${obj.rewards.points} points + ${obj.rewards.currency} coins â€¢Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Deadline: ${new Date(obj.deadline).toLocaleDateString()}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `).join('') || '<p>No active objectives</p>';
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Failed to load objectives:', error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function followTeam(teamId) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await apiCall(`/teams/${teamId}/follow?user_id=${fanUser.userId}`, 'POST');
Â  Â  Â  Â  Â  Â  Â  Â  showMessage('Team followed!');
Â  Â  Â  Â  Â  Â  Â  Â  if (fanUser) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fanUser.followingTeams = fanUser.followingTeams || [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fanUser.followingTeams.push(teamId);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  loadTeams();
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Failed to follow team:', error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function unfollowTeam(teamId) {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await apiCall(`/teams/${teamId}/follow?user_id=${fanUser.userId}`, 'DELETE');
Â  Â  Â  Â  Â  Â  Â  Â  showMessage('Team unfollowed');
Â  Â  Â  Â  Â  Â  Â  Â  if (fanUser) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  fanUser.followingTeams = fanUser.followingTeams.filter(id => id !== teamId);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  loadTeams();
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Failed to unfollow team:', error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function tipTeam(teamId) {
Â  Â  Â  Â  Â  Â  const amount = prompt('How much would you like to tip?', '100');
Â  Â  Â  Â  Â  Â  if (!amount) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const result = await apiCall(`/teams/${teamId}/tip?user_id=${fanUser.userId}`, 'POST', {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  amount: parseInt(amount)
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  showMessage(result.message);
Â  Â  Â  Â  Â  Â  Â  Â  await updateWallet();
Â  Â  Â  Â  Â  Â  Â  Â  await loadTeams();
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Failed to tip team:', error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function updateWallet() {
Â  Â  Â  Â  Â  Â  if (!fanUser) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const result = await apiCall(`/wallet/balance?user_id=${fanUser.userId}`);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('balance').textContent = result.balance;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('username').textContent = fanUser.username || 'Guest User';
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Failed to update wallet:', error);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  async function init() {
Â  Â  Â  Â  Â  Â  // Get the hardcoded fan user from the API
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  fanUser = await apiCall('/users/fan');
Â  Â  Â  Â  Â  Â  Â  Â  if (!fanUser) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error("Fan user not found");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  updateWallet();
Â  Â  Â  Â  Â  Â  Â  Â  loadTeams();
Â  Â  Â  Â  Â  Â  Â  Â  loadObjectives();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Refresh every 30 seconds
Â  Â  Â  Â  Â  Â  Â  Â  setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadTeams();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  loadObjectives();
Â  Â  Â  Â  Â  Â  Â  Â  }, 30000);
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Initialization failed:', error);
Â  Â  Â  Â  Â  Â  Â  Â  showMessage('Application failed to initialize. Check console for details.', 'error');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // Start the app
Â  Â  Â  Â  init();
Â  Â  </script>
</body>
</html>